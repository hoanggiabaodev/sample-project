@{
    ViewData["Title"] = "Quản lý danh mục tin tức";
    ViewData["Description"] = "Quản lý danh mục tin tức";
    Layout = "_LayoutDashmin";
}

<style>
    .header-logo {
        border-radius: 8px;
        padding: 8px 12px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .header-logo-icon {
        width: 24px;
        height: 24px;
        background: white;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: bold;
        color: #047857;
    }

    .filter-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
    }

    .filter-label {
        font-size: 14px;
        font-weight: 500;
        color: #374151;
    }

    .filter-select,
    .filter-input {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 14px;
        background: white;
    }

    .filter-select:focus,
    .filter-input:focus {
        outline: none;
        border-color: #047857;
        box-shadow: 0 0 0 3px rgba(4, 120, 87, 0.1);
    }

    .search-input {
        padding: 6px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 14px;
        width: 250px;
    }

    .table-custom {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
    }

    .table-custom thead {
        background: #f9fafb;
    }

    .table-custom th {
        padding: 12px;
        text-align: left;
        font-weight: 600;
        color: #374151;
        border-bottom: 1px solid #e5e7eb;
    }

    .table-custom td {
        padding: 12px;
        border-bottom: 1px solid #f3f4f6;
    }

    .table-custom tbody tr:hover {
        background: #f9fafb;
    }

    .select2-container--default .select2-selection--single {
        height: 44px;
        padding: 8px 12px;
        border-radius: 0.375rem;
        font-size: 16px;
        line-height: 28px;
    }

    .select2-container--default .select2-selection--single .select2-selection__rendered {
        line-height: 28px;
    }

    .select2-selection.select2-selection--single {
        height: max-content !important;
        min-height: unset !important;
        padding-top: 0.25rem;
        padding-bottom: 0.25rem;
        line-height: normal;
    }


    .btn-search,
    .btn-success {
        height: 44px;
        font-size: 16px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    #categoriesDataTable.dataTable tbody td,
    #categoriesDataTable.dataTable thead th {
        border: 1px solid #dee2e6;
    }

    #categoriesDataTable.dataTable {
        border-collapse: collapse;
        border: 1px solid #dee2e6;
    }

    #categoriesDataTable.dataTable tbody tr:hover {
        background-color: #f1f3f5;
    }
</style>

<div class="text-white px-4 py-3" style="background: linear-gradient(135deg, #047857 0%, #059669 100%);">
    <div class="d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center gap-3">
            <a href="#" class="text-white sidebar-toggler flex-shrink-0">
                <i class="fa fa-bars"></i>
            </a>
            <button style="background: none; border: none; color: white; cursor: pointer;">
                <i class="fa fa-home" style="font-size: 16px;"></i>
            </button>
            <div class="header-logo">
                <div class="header-logo-icon">TBC</div>
                <span style="font-weight: 500;">QUẢN LÝ - DANH MỤC</span>
            </div>
            <div class="d-flex align-items-center gap-2" style="font-size: 14px;">
                <i class="fa fa-calendar" style="font-size: 14px;"></i>
                <span id="currentDateTime"></span>
            </div>
        </div>
        <div class="d-flex align-items-center gap-3">
            <div class="text-end" style="font-size: 14px;">
                <div>TK: admin | Tên: Quản trị viên</div>
                <div class="text-white-50" style="font-size: 12px;">ADMIN</div>
            </div>
            <div class="d-flex align-items-center justify-content-center rounded-circle"
                style="width:32px; height:32px; background:rgba(255,255,255,0.2);">
                <i class="fa fa-user" style="font-size: 14px;"></i>
            </div>
        </div>
    </div>
</div>

<nav class="bg-white border-bottom py-2 px-3" aria-label="breadcrumb">
    <ol class="breadcrumb d-flex align-items-center gap-2 fs-6 text-secondary mb-0">
        <li class="breadcrumb-item">
            <i class="fa fa-home" style="font-size: 14px;"></i>
        </li>
        <li class="breadcrumb-item">Quản lý</li>
        <li class="breadcrumb-item active fw-medium text-dark" aria-current="page">
            Danh mục tin tức
        </li>
        <li class="ms-auto">
            <button type="button" class="btn btn-outline-theme btn-success rounded-1 px-2 py-1" data-bs-toggle="modal"
                data-bs-target="#addCategoryModal"
                style="transition: all 0.3s ease; background-color: #fff; color: #198754; border: 1px solid #198754;"
                onmouseover="this.style.backgroundColor='#198754'; this.style.color='#fff'; this.style.borderColor='#198754';"
                onmouseout="this.style.backgroundColor='#fff'; this.style.color='#198754'; this.style.borderColor='#198754';">
                <i class="fa fa-plus"></i> Thêm danh mục
            </button>

        </li>
    </ol>
</nav>

<div class="mt-4 bg-gray-50 min-h-[calc(100vh-120px)]">
    <div class="bg-white rounded-lg p-6">
        <div class="filter-section d-flex flex-wrap align-items-end">
            <div class="d-flex flex-column flex-grow-1">
                <label class="filter-label mb-1">Danh mục</label>
                <select class="form-select" id="categoryFilter">
                    <option value="">Danh mục tin tức</option>
                    <option value="1">Quân sự</option>
                    <option value="0">Giải trí</option>
                </select>
            </div>

            <div class="d-flex flex-column flex-grow-1">
                <label class="filter-label mb-1">Trạng thái</label>
                <select class="form-select" id="statusFilter">
                    <option value="">Tất cả trạng thái</option>
                    <option value="1">Hoạt động</option>
                    <option value="0">Không hoạt động</option>
                </select>
            </div>

            <div>
                <button type="button" class="btn btn-success rounded-2 px-4 py-1 d-flex align-items-center gap-2"
                    id="btnSearch"
                    style="font-size: 14px; transition: all 0.3s ease; background-color: #fff; color: #198754; border: 1px solid #198754;"
                    onmouseover="this.style.backgroundColor='#198754'; this.style.color='#fff'; this.style.borderColor='#198754';"
                    onmouseout="this.style.backgroundColor='#fff'; this.style.color='#198754'; this.style.borderColor='#198754';">
                    <i class="fa fa-search"></i>
                </button>

            </div>
        </div>

        <div class="table-wrapper rounded border overflow-hidden p-3">
            <table class="table-custom" id="categoriesDataTable">
                <thead>
                    <tr>
                        <th class="text-center">Xem</th>
                        <th class="text-center" style="width: 50px;">Mã</th>
                        <th class="text-center">TÊN DANH MỤC</th>
                        <th class="text-center">URL META</th>
                        <th class="text-center" style="width: 120px;">TRẠNG THÁI</th>
                        <th class="text-center" style="width: 150px;">NGÀY TẠO</th>
                        <th class="text-center" style="width: 150px;">CẬP NHẬT</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="modal fade" id="addCategoryModal" tabindex="-1" aria-labelledby="addCategoryModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addCategoryModalLabel">Thêm danh mục mới</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addCategoryForm">
                    <div class="mb-3">
                        <label for="categoryName" class="form-label">Tên danh mục *</label>
                        <input type="text" class="form-control" id="categoryName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="categoryStatus" class="form-label">Trạng thái</label>
                        <select class="form-select" id="categoryStatus" name="status">
                            <option value="1">Hoạt động</option>
                            <option value="0">Không hoạt động</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="categoryMetaUrl" class="form-label">URL Meta</label>
                        <input type="text" class="form-control" id="categoryMetaUrl" name="metaUrl"
                            placeholder="url-meta-danh-muc">
                        <div class="form-text">URL thân thiện cho SEO (tùy chọn)</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-primary" id="btnSaveCategory">Lưu</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="editCategoryModal" tabindex="-1" aria-labelledby="editCategoryModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editCategoryModalLabel">Chỉnh sửa danh mục</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editCategoryForm">
                    <input type="hidden" id="editCategoryId" name="id">
                    <div class="mb-3">
                        <label for="editCategoryName" class="form-label">Tên danh mục *</label>
                        <input type="text" class="form-control" id="editCategoryName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="editCategoryStatus" class="form-label">Trạng thái</label>
                        <select class="form-select" id="editCategoryStatus" name="status">
                            <option value="1">Hoạt động</option>
                            <option value="0">Không hoạt động</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="editCategoryMetaUrl" class="form-label">URL Meta</label>
                        <input type="text" class="form-control" id="editCategoryMetaUrl" name="metaUrl"
                            placeholder="url-meta-danh-muc">
                        <div class="form-text">URL thân thiện cho SEO (tùy chọn)</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-primary" id="btnUpdateCategory">Cập nhật</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="viewCategoryModal" tabindex="-1" aria-labelledby="viewCategoryModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewCategoryModalLabel">Chi tiết danh mục</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="viewCategoryContent">
                Content will be loaded here
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="deleteCategoryModal" tabindex="-1" aria-labelledby="deleteCategoryModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteCategoryModalLabel">Xác nhận xóa</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Bạn có chắc chắn muốn xóa danh mục này không?</p>
                <p class="text-danger"><strong>Hành động này không thể hoàn tác!</strong></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-danger" id="btnConfirmDelete">Xóa</button>
            </div>
        </div>
    </div>
</div>

<script>
    function updateDateTime() {
        const now = new Date();

        const datePart = now.toLocaleDateString('vi-VN', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
        });

        const timePart = now.toLocaleTimeString('en-US', {  
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: true
        });

        const formatted = `${datePart} - ${timePart}`;

        document.getElementById('currentDateTime').textContent = formatted;
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();
</script>

@section Scripts {
    <link rel="stylesheet" type="text/css" href="~/lib/datatable/css/datatables.min.css">
    <link rel="stylesheet" type="text/css" href="~/lib/datatable/css/responsive.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="~/lib/select2/css/select2.min.css">
    <link rel="stylesheet" type="text/css" href="~/lib/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css">
    <script src="~/lib/ckeditor/ckeditor.js"></script>
    <script type="text/javascript" src="~/lib/datatable/js/datatables.min.js"></script>
    <script type="text/javascript" src="~/lib/datatable/js/datatables.bootstrap4.min.js"></script>
    <script type="text/javascript" src="~/lib/datatable/js/dataTables.responsive.min.js"></script>
    <script src="~/lib/select2/js/select2.min.js"></script>
    <script src="~/lib/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
    <script src="~/lib/bootstrap-datepicker/dist/js/il8n/vi.js"></script>
    <link rel="stylesheet" href="~/lib/izi-toast-mater/css/iziToast.min.css">
    <script src="~/lib/izi-toast-mater/iziToast.min.js"></script>
    <script src="~/js/call-api.js"></script>
    <script src="~/controllers/new_categories_management.js"></script>
}
