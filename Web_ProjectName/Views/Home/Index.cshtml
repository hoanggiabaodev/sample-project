@{
    ViewData["Title"] = "Tin Tức";
    ViewData["Description"] = "Trang tin tức mới nhất";
    Layout = "_LayoutNews";
}

<style>
    @@keyframes float {
        0% {
            transform: translateX(-100px);
        }

        100% {
            transform: translateX(100px);
        }
    }

    .trending-area::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: conic-gradient(from 0deg, transparent 340deg, rgba(255, 255, 255, 0.1) 360deg);
        animation: rotate 30s linear infinite;
    }

    @@keyframes rotate {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .most-recent-cap h4 a {
        color: #2c3e50 !important;
        text-decoration: none !important;
        transition: color 0.3s ease !important;
    }

    .most-recent-cap h4 a:hover {
        color: #007bff !important;
    }

    .most-recent:hover {
        transform: translateY(-2px);
        transition: all 0.3s ease;
    }

    .most-recent {
        border-radius: 8px;
        padding: 8px;
        transition: all 0.3s ease;
    }

    .most-recent:hover {
        background-color: #f8f9fa;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .span-name {
        color: #000;
        text-decoration: none;
        transition: color 0.3s ease, transform 0.3s ease;
        display: inline-block; 
    }

    .span-name:hover {
        color: #007bff;
        text-decoration: none;
    }

    .img-zoom {
        overflow: hidden; 
        display: inline-block;
    }

    .img-zoom img {
        transition: transform 0.4s ease;
    }

    .img-zoom img:hover {
        transform: scale(1.1); 
    }

    .category-box {
        border: 1px solid #e5e7eb;
        background: #ffffff;
        border-radius: 1px;
        padding: 12px;
    }

    #category-list {
        gap: 8px !important;
    }

    .category-pill {
        display: inline-block;
        padding: 8px 14px;
        border: 1px solid #e5e7eb;
        border-radius: 999px;
        background: #f9fafb;
        color: #111827;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        transition: background-color .2s ease, border-color .2s ease, transform .1s ease;
    }

    .category-pill:hover {
        background: #f3f4f6;
        border-color: #d1d5db;
        text-decoration: none;
    }

    .category-action-btn {
        display: inline-block;
        padding: 8px 14px;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        background: #ffffff;
        color: #111827;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color .2s ease, border-color .2s ease, transform .1s ease;
    }

    .category-pill {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 12px 20px;
        background-color: #fff;
        border-radius: 8px;
        color: #333;
        text-decoration: none;
        transition: all 0.3s ease;
        cursor: pointer;
        width: 140px; 
        text-align: center;
        white-space: nowrap;
        font-weight: 500;
    }

    .category-pill:hover {
        background-color: #ff5722;
        color: #fff;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        transform: translateY(-2px);
    }
</style>

<div class="trending-area fix"
    style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); position: relative; overflow: hidden;">
    <div
        style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 1px, transparent 1px), radial-gradient(circle at 80% 50%, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 100px 100px; animation: float 20s linear infinite;">
    </div>

    <div class="container" style="position: relative; z-index: 2;">
        <div class="trending-main py-5">
            <div class="row align-items-center">
                <div class="col-lg-12">
                    <div class="trending-top">
                        <div class="trend-top-img"
                            style="position: relative; border-radius: 18px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.15);">

                            <img src="~/images/demo_images.webp" alt="Tin tức nổi bật"
                                style="width: 100%; height: 400px; object-fit: cover; filter: brightness(0.85);">

                            <div class="trend-top-cap" style="position: absolute; bottom: 0; left: 0; right: 0; 
                   background: linear-gradient(to top, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.4) 60%, transparent 100%);
                   padding: 30px; color: white;">

                                <span style="display: inline-flex; align-items: center; gap: 6px;
                       background: linear-gradient(135deg, #ff4e50, #f9d423);
                       color: white; padding: 6px 14px; border-radius: 50px;
                       font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;
                       box-shadow: 0 3px 10px rgba(0,0,0,0.3);">
                                    <i class="fas fa-bolt"></i> Tin tức mới nhất
                                </span>

                                <h4 style="font-size: 26px; font-weight: 800; line-height: 1.3; margin: 12px 0 0 0;
           color: #ffffff; 
           text-shadow: 0 2px 6px rgba(0,0,0,0.8);">
                                    Tin tức nổi bật trong ngày
                                </h4>

                                <p style="font-size: 15px; opacity: 0.95; margin: 8px 0 0 0; font-weight: 400;
          color: #ffffff;
          text-shadow: 0 2px 4px rgba(0,0,0,0.8);">
                                    Cập nhật những thông tin mới nhất và quan trọng nhất
                                </p>
                            </div>
                            <div style="position: absolute; top: 18px; right: 18px;
                   width: 48px; height: 48px;
                   background: rgba(255,255,255,0.15);
                   border-radius: 50%; backdrop-filter: blur(8px);
                   display: flex; align-items: center; justify-content: center;
                   box-shadow: 0 4px 12px rgba(0,0,0,0.25);">
                                <i class="fas fa-newspaper" style="font-size: 20px; color: white;"></i>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<section class="whats-news-area pt-50 pb-20">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="section-tittle mb-30">
                    <h3>Tin Tức Mới Nhất</h3>
                </div>

                @if (ViewBag.Categories != null)
                {
                    <div class="mb-4">
                        <div class="category-box">
                            <h5 class="mb-2 small fw-normal text-secondary"> <i class="fas fa-tags"></i> Danh mục tin tức</h5>
                            <div id="category-list" class="d-flex flex-wrap"></div>
                        </div>
                    </div>
                }

                <div id="news-list">
                    @{
                        var newsList = ViewBag.NewsList as List<Web_ProjectName.Models.M_News> ?? new List<Web_ProjectName.Models.M_News>();
                    }
                    @if (newsList.Count == 0)
                    {
                        <div class="alert alert-light">Chưa có tin tức.</div>
                    }
                    else
                    {
                        foreach (var n in newsList)
                        {
                            <div class="single-whats-news mb-30 p-2 border rounded-2">
                                <a class="row g-3 align-items-center text-decoration-none" href="/home/detail?metaUrl=@(n.metaUrl)">
                                    <div class="col-3 img-zoom">
                                        <img src="~/images/demo_images.webp" class="img-fluid rounded" alt="@n.name" />
                                    </div>
                                    <div class="col-9">
                                            <span class="span-name text-black fw-bold">@n.name</span>
                                        <div class="text-muted small mb-1">@n.publishedAt?.ToString("dd/MM/yyyy")</div>
                                        <div class="small">@Html.Raw(n.description)</div>
                                    </div>
                                </a>
                            </div>
                        }
                    }
                </div>

                <div id="news-detail-container"></div>

                @if ((int)(ViewBag.TotalPages ?? 1) > 1)
                {
                    var current = (int)ViewBag.CurrentPage;
                    var total = (int)ViewBag.TotalPages;
                    var cid = (int?)ViewBag.CategoryId;
                    var kw = (string)ViewBag.Keyword ?? "";
                    string link(int p) => $"?page={p}{(cid.HasValue ? $"&categoryId={cid}" : "")}{(!string.IsNullOrWhiteSpace(kw) ? $"&keyword={kw}" : "")}";
                    <nav class="blog-pagination justify-content-center d-flex">
                        <ul class="pagination">
                            <li class="page-item @(current == 1 ? "disabled" : "")">
                                <a href="@(current == 1 ? "#" : link(current-1))" class="page-link" aria-label="Previous">
                                    <i class="ti-angle-left"></i>
                                </a>
                            </li>
                            @for (int i = 1; i <= total; i++)
                            {
                                <li class="page-item @(i == current ? "active" : "")">
                                    <a class="page-link" href="@link(i)">@i</a>
                                </li>
                            }
                            <li class="page-item @(current == total ? "disabled" : "")">
                                <a class="page-link" href="@(current == total ? "#" : link(current+1))" aria-label="Next">
                                    <i class="ti-angle-right"></i>
                                </a>
                            </li>
                        </ul>
                    </nav>
                }
            </div>

            <div class="col-lg-4">
                <div class="trending-top mb-30">
                    <div class="section-tittle mb-30">
                        <h3>Tin Nổi Bật</h3>
                    </div>
                    <div id="featured-news-container">
                        <div class="text-center">
                            <i class="fas fa-spinner fa-spin"></i> Đang tải tin nổi bật...
                        </div>
                    </div>
                </div>

                <div class="single-follow mb-45">
                    <div class="single-box">
                        <div class="follow-us d-flex align-items-center">
                            <div class="follow-social">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                            </div>
                            <div class="follow-count">
                                <span>8,045</span>
                                <p>Fans</p>
                            </div>
                        </div>
                        <div class="follow-us d-flex align-items-center">
                            <div class="follow-social">
                                <a href="#"><i class="fab fa-twitter"></i></a>
                            </div>
                            <div class="follow-count">
                                <span>9,532</span>
                                <p>Followers</p>
                            </div>
                        </div>
                        <div class="follow-us d-flex align-items-center">
                            <div class="follow-social">
                                <a href="#"><i class="fab fa-instagram"></i></a>
                            </div>
                            <div class="follow-count">
                                <span>7,541</span>
                                <p>Followers</p>
                            </div>
                        </div>
                        <div class="follow-us d-flex align-items-center">
                            <div class="follow-social">
                                <a href="#"><i class="fab fa-youtube"></i></a>
                            </div>
                            <div class="follow-count">
                                <span>9,532</span>
                                <p>Subscriber</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="most-recent-area">
                    <div class="small-tittle mb-20">
                        <h4>Xem Nhiều Nhất</h4>
                    </div>
                    <div class="most-recent mb-40">
                        <div class="most-recent-img">
                            <img src="~/images/demo_images.webp" alt="">
                            <div class="most-recent-cap">
                                <span class="bgbeg">01</span>
                                <h4><a href="#">Tin tức nổi bật nhất tuần</a></h4>
                                <p>@DateTime.Now.ToString("dd MMM yyyy")</p>
                            </div>
                        </div>
                    </div>
                    <div class="most-recent mb-40">
                        <div class="most-recent-img">
                            <img src="~/images/demo_images.webp" alt="">
                            <div class="most-recent-cap">
                                <span class="bgbeg">02</span>
                                <h4><a href="#">Thông tin kinh tế mới nhất</a></h4>
                                <p>@DateTime.Now.ToString("dd MMM yyyy")</p>
                            </div>
                        </div>
                    </div>
                    <div class="most-recent mb-40">
                        <div class="most-recent-img">
                            <img src="~/images/demo_images.webp" alt="">
                            <div class="most-recent-cap">
                                <span class="bgbeg">03</span>
                                <h4><a href="#">Tin thể thao hấp dẫn</a></h4>
                                <p>@DateTime.Now.ToString("dd MMM yyyy")</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <link rel="stylesheet" type="text/css" href="~/lib/datatable/css/datatables.min.css">
    <link rel="stylesheet" type="text/css" href="~/lib/datatable/css/responsive.dataTables.min.css">

    <link rel="stylesheet" type="text/css" href="~/lib/select2/css/select2.min.css">

    <link rel="stylesheet" type="text/css" href="~/lib/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css">

    <script src="~/lib/ckeditor/ckeditor.js"></script>

    <script type="text/javascript" src="~/lib/datatable/js/datatables.min.js"></script>
    <script type="text/javascript" src="~/lib/datatable/js/datatables.bootstrap4.min.js"></script>
    <script type="text/javascript" src="~/lib/datatable/js/dataTables.responsive.min.js"></script>

    <script src="~/lib/select2/js/select2.min.js"></script>

    <script src="~/lib/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
    <script src="~/lib/bootstrap-datepicker/dist/js/il8n/vi.js"></script>

    <link rel="stylesheet" href="~/lib/izi-toast-mater/css/iziToast.min.css">
    <script src="~/lib/izi-toast-mater/iziToast.min.js"></script>
    <script src="~/js/call-api.js"></script>
    <script src="~/controllers/new.js"></script>
}